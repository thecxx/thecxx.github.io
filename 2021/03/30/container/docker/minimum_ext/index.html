<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="士不可以不弘毅，任重而道远。"><title>最小化docker镜像(补充内容) | KAMI</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//fastly.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//fastly.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//fastly.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/css/prettify/prettify.css"><script type="text/javascript" src="//fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script type="text/javascript" src="//fastly.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//fastly.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//fastly.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">最小化docker镜像(补充内容)</h1><a id="logo" href="/.">KAMI</a><p class="description">士不可以不弘毅，任重而道远。</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/guestbook/"><i class="fa fa-book"> 留言</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">最小化docker镜像(补充内容)</h1><div class="post-meta">Mar 30 2021<span> | </span><span class="category"><a href="/categories/容器/">容器</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> 阅读</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.4k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 7</span><span class="post-meta-item-text"> 分钟</span></span></span></div><div class="post-content"><p>基于之前写的一篇《最小化docker镜像》做一些补充，对用到的工具，做一些解释和对比。</p>
<a id="more"></a>
<h2 id="Go程序构建时的-ldflags编译选项"><a href="#Go程序构建时的-ldflags编译选项" class="headerlink" title="Go程序构建时的-ldflags编译选项"></a>Go程序构建时的<code>-ldflags</code>编译选项</h2><p>构建程序时，引入选项<code>-ldflags=&quot;-w -s&quot;</code>，平均单个文件大小减小20%左右</p>
<p><strong>Command:</strong> <code>go tool link</code> ↓<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">usage: link [options] main.o</span><br><span class="line">  -B note</span><br><span class="line">    	add an ELF NT_GNU_BUILD_ID note when using ELF</span><br><span class="line">  -E entry</span><br><span class="line">    	<span class="keyword">set</span> entry symbol <span class="keyword">name</span></span><br><span class="line">  -H <span class="keyword">type</span></span><br><span class="line">    	<span class="keyword">set</span> header <span class="keyword">type</span></span><br><span class="line">  -I linker</span><br><span class="line">    	<span class="keyword">use</span> linker <span class="keyword">as</span> ELF dynamic linker</span><br><span class="line">  -L <span class="keyword">directory</span></span><br><span class="line">    	<span class="keyword">add</span> specified <span class="keyword">directory</span> <span class="keyword">to</span> <span class="keyword">library</span> <span class="keyword">path</span></span><br><span class="line">  -R quantum</span><br><span class="line">    	<span class="keyword">set</span> address rounding quantum (<span class="keyword">default</span> <span class="number">-1</span>)</span><br><span class="line">  -T address</span><br><span class="line">    	<span class="keyword">set</span> <span class="built_in">text</span> <span class="keyword">segment</span> address (<span class="keyword">default</span> <span class="number">-1</span>)</span><br><span class="line">  -V	print <span class="keyword">version</span> <span class="keyword">and</span> <span class="keyword">exit</span></span><br><span class="line">  -X definition</span><br><span class="line">    	<span class="keyword">add</span> <span class="keyword">string</span> <span class="keyword">value</span> definition <span class="keyword">of</span> the <span class="keyword">form</span> importpath.name=<span class="keyword">value</span></span><br><span class="line">  -a	disassemble <span class="keyword">output</span></span><br><span class="line">  -buildid <span class="keyword">id</span></span><br><span class="line">    	<span class="built_in">record</span> <span class="keyword">id</span> <span class="keyword">as</span> <span class="keyword">Go</span> toolchain <span class="keyword">build</span> <span class="keyword">id</span></span><br><span class="line">  -buildmode <span class="keyword">mode</span></span><br><span class="line">    	<span class="keyword">set</span> <span class="keyword">build</span> <span class="keyword">mode</span></span><br><span class="line">  -c	dump <span class="keyword">call</span> graph</span><br><span class="line">  -compressdwarf</span><br><span class="line">    	<span class="keyword">compress</span> DWARF <span class="keyword">if</span> possible (<span class="keyword">default</span> <span class="literal">true</span>)</span><br><span class="line">  -cpuprofile <span class="keyword">file</span></span><br><span class="line">    	write cpu profile <span class="keyword">to</span> <span class="keyword">file</span></span><br><span class="line">  -d	<span class="keyword">disable</span> dynamic executable</span><br><span class="line">  -debugtramp <span class="built_in">int</span></span><br><span class="line">    	debug trampolines</span><br><span class="line">  -dumpdep</span><br><span class="line">    	dump symbol dependency graph</span><br><span class="line">  -extar <span class="keyword">string</span></span><br><span class="line">    	<span class="keyword">archive</span> program <span class="keyword">for</span> buildmode=c-<span class="keyword">archive</span></span><br><span class="line">  -extld linker</span><br><span class="line">    	<span class="keyword">use</span> linker <span class="keyword">when</span> linking <span class="keyword">in</span> <span class="keyword">external</span> <span class="keyword">mode</span></span><br><span class="line">  -extldflags flags</span><br><span class="line">    	pass flags <span class="keyword">to</span> <span class="keyword">external</span> linker</span><br><span class="line">  -f	<span class="keyword">ignore</span> <span class="keyword">version</span> mismatch</span><br><span class="line">  -g	<span class="keyword">disable</span> <span class="keyword">go</span> <span class="keyword">package</span> <span class="keyword">data</span> checks</span><br><span class="line">  -h	halt <span class="keyword">on</span> <span class="keyword">error</span></span><br><span class="line">  -importcfg <span class="keyword">file</span></span><br><span class="line">    	<span class="keyword">read</span> <span class="keyword">import</span> configuration <span class="keyword">from</span> <span class="keyword">file</span></span><br><span class="line">  -installsuffix suffix</span><br><span class="line">    	<span class="keyword">set</span> <span class="keyword">package</span> <span class="keyword">directory</span> suffix</span><br><span class="line">  -k symbol</span><br><span class="line">    	<span class="keyword">set</span> <span class="keyword">field</span> <span class="keyword">tracking</span> symbol</span><br><span class="line">  -libgcc <span class="keyword">string</span></span><br><span class="line">    	compiler support lib <span class="keyword">for</span> internal linking; <span class="keyword">use</span> <span class="string">"none"</span> <span class="keyword">to</span> <span class="keyword">disable</span></span><br><span class="line">  -linkmode <span class="keyword">mode</span></span><br><span class="line">    	<span class="keyword">set</span> <span class="keyword">link</span> <span class="keyword">mode</span></span><br><span class="line">  -linkshared</span><br><span class="line">    	<span class="keyword">link</span> against installed <span class="keyword">Go</span> <span class="keyword">shared</span> libraries</span><br><span class="line">  -memprofile <span class="keyword">file</span></span><br><span class="line">    	write <span class="keyword">memory</span> profile <span class="keyword">to</span> <span class="keyword">file</span></span><br><span class="line">  -memprofilerate rate</span><br><span class="line">    	<span class="keyword">set</span> runtime.MemProfileRate <span class="keyword">to</span> rate</span><br><span class="line">  -msan</span><br><span class="line">    	<span class="keyword">enable</span> MSan <span class="keyword">interface</span></span><br><span class="line">  -n	dump symbol <span class="keyword">table</span></span><br><span class="line">  -o <span class="keyword">file</span></span><br><span class="line">    	write <span class="keyword">output</span> <span class="keyword">to</span> <span class="keyword">file</span></span><br><span class="line">  -pluginpath <span class="keyword">string</span></span><br><span class="line">    	<span class="keyword">full</span> <span class="keyword">path</span> <span class="keyword">name</span> <span class="keyword">for</span> <span class="keyword">plugin</span></span><br><span class="line">  -r <span class="keyword">path</span></span><br><span class="line">    	<span class="keyword">set</span> the ELF dynamic linker <span class="keyword">search</span> <span class="keyword">path</span> <span class="keyword">to</span> dir1:dir2:...</span><br><span class="line">  -race</span><br><span class="line">    	<span class="keyword">enable</span> race detector</span><br><span class="line">  -s	<span class="keyword">disable</span> symbol <span class="keyword">table</span> // 删除符号表</span><br><span class="line">  -strictdups <span class="built_in">int</span></span><br><span class="line">    	sanity <span class="keyword">check</span> <span class="keyword">duplicate</span> symbol <span class="keyword">contents</span> during <span class="keyword">object</span> <span class="keyword">file</span> reading (<span class="number">1</span>=warn <span class="number">2</span>=err).</span><br><span class="line">  -tmpdir <span class="keyword">directory</span></span><br><span class="line">    	<span class="keyword">use</span> <span class="keyword">directory</span> <span class="keyword">for</span> <span class="keyword">temporary</span> files</span><br><span class="line">  -u	<span class="keyword">reject</span> <span class="keyword">unsafe</span> packages</span><br><span class="line">  -v	print <span class="keyword">link</span> <span class="keyword">trace</span></span><br><span class="line">  -w	<span class="keyword">disable</span> DWARF generation // 删除DWARF调试信息</span><br></pre></td></tr></table></figure></p>
<h2 id="UPX压缩工具"><a href="#UPX压缩工具" class="headerlink" title="UPX压缩工具"></a>UPX压缩工具</h2><p>“<a href="https://upx.github.io/" target="_blank" rel="noopener"><strong>UPX</strong></a> is a free, portable, extendable, high-performance executable packer for several executable formats.”</p>
<p>源代码: <a href="https://github.com/upx/upx" target="_blank" rel="noopener">https://github.com/upx/upx</a></p>
<p><strong>Command:</strong> <code>upx --help</code> ↓<br><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">                       Ultimate Packer for eXecutables</span><br><span class="line">                          Copyright (C) 1996 - 2020</span><br><span class="line">UPX 3.96        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Jan 23rd 2020</span><br><span class="line"></span><br><span class="line">Usage: upx [-123456789dlthVL] [-qvfk] [-o file] file..</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  -<span class="ruby"><span class="number">1</span>     compress faster                   -<span class="number">9</span>    compress better</span></span><br><span class="line"><span class="ruby">  --best compress best (can be slow <span class="keyword">for</span> big files)</span></span><br><span class="line"><span class="ruby">  -d     decompress                        -l    list compressed file</span></span><br><span class="line"><span class="ruby">  -t     test compressed file              -V    display version number</span></span><br><span class="line"><span class="ruby">  -h     give this help                    -L    display software license</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby"><span class="symbol">Options:</span></span></span><br><span class="line"><span class="ruby">  -q     be quiet                          -v    be verbose</span></span><br><span class="line"><span class="ruby">  -oFILE write output to <span class="string">'FILE'</span></span></span><br><span class="line"><span class="ruby">  -f     force compression of suspicious files</span></span><br><span class="line"><span class="ruby">  --no-color, --mono, --color, --no-progress   change look</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Compression tuning <span class="symbol">options:</span></span></span><br><span class="line"><span class="ruby">  --brute             try all available compression methods &amp; filters [slow]</span></span><br><span class="line"><span class="ruby">  --ultra-brute       try even more compression variants [very slow]</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Backup <span class="symbol">options:</span></span></span><br><span class="line"><span class="ruby">  -k, --backup        keep backup files</span></span><br><span class="line"><span class="ruby">  --no-backup         no backup files [default]</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Overlay <span class="symbol">options:</span></span></span><br><span class="line"><span class="ruby">  --overlay=copy      copy any extra data attached to the file [default]</span></span><br><span class="line"><span class="ruby">  --overlay=strip     strip any extra data attached to the file [DANGEROUS]</span></span><br><span class="line"><span class="ruby">  --overlay=skip      don<span class="string">'t compress a file with an overlay</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> djgpp2/<span class="symbol">coff:</span></span></span><br><span class="line"><span class="ruby">  --coff              produce COFF output [<span class="symbol">default:</span> EXE]</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> dos/<span class="symbol">com:</span></span></span><br><span class="line"><span class="ruby">  --<span class="number">8086</span>              make compressed com work on any <span class="number">8086</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> dos/<span class="symbol">exe:</span></span></span><br><span class="line"><span class="ruby">  --<span class="number">8086</span>              make compressed exe work on any <span class="number">8086</span></span></span><br><span class="line"><span class="ruby">  --no-reloc          put no relocations <span class="keyword">in</span> to the exe header</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> dos/<span class="symbol">sys:</span></span></span><br><span class="line"><span class="ruby">  --<span class="number">8086</span>              make compressed sys work on any <span class="number">8086</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> ps1/<span class="symbol">exe:</span></span></span><br><span class="line"><span class="ruby">  --<span class="number">8</span>-bit             uses <span class="number">8</span> bit size compression [<span class="symbol">default:</span> <span class="number">32</span> bit]</span></span><br><span class="line"><span class="ruby">  --<span class="number">8</span>mib-ram          <span class="number">8</span> megabyte memory limit [<span class="symbol">default:</span> <span class="number">2</span> MiB]</span></span><br><span class="line"><span class="ruby">  --boot-only         disables client/host transfer compatibility</span></span><br><span class="line"><span class="ruby">  --no-align          don<span class="string">'t align to 2048 bytes [enables: --console-run]</span></span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> watcom/<span class="symbol">le:</span></span></span><br><span class="line"><span class="ruby">  --le                produce LE output [<span class="symbol">default:</span> EXE]</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> win32/pe, win64/pe, rtm32/pe &amp; arm/<span class="symbol">pe:</span></span></span><br><span class="line"><span class="ruby">  --compress-exports=<span class="number">0</span>    <span class="keyword">do</span> <span class="keyword">not</span> compress the export section</span></span><br><span class="line"><span class="ruby">  --compress-exports=<span class="number">1</span>    compress the export section [default]</span></span><br><span class="line"><span class="ruby">  --compress-icons=<span class="number">0</span>      <span class="keyword">do</span> <span class="keyword">not</span> compress any icons</span></span><br><span class="line"><span class="ruby">  --compress-icons=<span class="number">1</span>      compress all but the first icon</span></span><br><span class="line"><span class="ruby">  --compress-icons=<span class="number">2</span>      compress all but the first icon directory [default]</span></span><br><span class="line"><span class="ruby">  --compress-icons=<span class="number">3</span>      compress all icons</span></span><br><span class="line"><span class="ruby">  --compress-resources=<span class="number">0</span>  <span class="keyword">do</span> <span class="keyword">not</span> compress any resources at all</span></span><br><span class="line"><span class="ruby">  --keep-resource=list    <span class="keyword">do</span> <span class="keyword">not</span> compress resources specified by list</span></span><br><span class="line"><span class="ruby">  --strip-relocs=<span class="number">0</span>        <span class="keyword">do</span> <span class="keyword">not</span> strip relocations</span></span><br><span class="line"><span class="ruby">  --strip-relocs=<span class="number">1</span>        strip relocations [default]</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">Options <span class="keyword">for</span> linux/<span class="symbol">elf:</span></span></span><br><span class="line"><span class="ruby">  --preserve-build-id     copy .gnu.note.build-id to compressed output</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">file..   executables to (de)compress</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">This version <span class="symbol">supports:</span></span></span><br><span class="line"><span class="ruby">    amd64-darwin.dylib                   dylib/amd64</span></span><br><span class="line"><span class="ruby">    amd64-darwin.macho                   macho/amd64</span></span><br><span class="line"><span class="ruby">    amd64-linux.elf                      linux/amd64</span></span><br><span class="line"><span class="ruby">    amd64-linux.kernel.vmlinux           vmlinux/amd64</span></span><br><span class="line"><span class="ruby">    amd64-win64.pe                       win64/pe</span></span><br><span class="line"><span class="ruby">    arm-darwin.macho                     macho/arm</span></span><br><span class="line"><span class="ruby">    arm-linux.elf                        linux/arm</span></span><br><span class="line"><span class="ruby">    arm-linux.kernel.vmlinux             vmlinux/arm</span></span><br><span class="line"><span class="ruby">    arm-linux.kernel.vmlinuz             vmlinuz/arm</span></span><br><span class="line"><span class="ruby">    arm-wince.pe                         arm/pe</span></span><br><span class="line"><span class="ruby">    arm64-darwin.macho                   macho/arm64</span></span><br><span class="line"><span class="ruby">    arm64-linux.elf                      linux/arm64</span></span><br><span class="line"><span class="ruby">    armeb-linux.elf                      linux/armeb</span></span><br><span class="line"><span class="ruby">    armeb-linux.kernel.vmlinux           vmlinux/armeb</span></span><br><span class="line"><span class="ruby">    fat-darwin.macho                     macho/fat</span></span><br><span class="line"><span class="ruby">    i086-dos16.com                       dos/com</span></span><br><span class="line"><span class="ruby">    i086-dos16.exe                       dos/exe</span></span><br><span class="line"><span class="ruby">    i086-dos16.sys                       dos/sys</span></span><br><span class="line"><span class="ruby">    i386-bsd.elf.execve                  bsd.exec/i386</span></span><br><span class="line"><span class="ruby">    i386-darwin.macho                    macho/i386</span></span><br><span class="line"><span class="ruby">    i386-dos32.djgpp2.coff               djgpp2/coff</span></span><br><span class="line"><span class="ruby">    i386-dos32.tmt.adam                  tmt/adam</span></span><br><span class="line"><span class="ruby">    i386-dos32.watcom.le                 watcom/le</span></span><br><span class="line"><span class="ruby">    i386-freebsd.elf                     freebsd/i386</span></span><br><span class="line"><span class="ruby">    i386-linux.elf                       linux/i386</span></span><br><span class="line"><span class="ruby">    i386-linux.elf.execve                linux.exec/i386</span></span><br><span class="line"><span class="ruby">    i386-linux.elf.shell                 linux.sh/i386</span></span><br><span class="line"><span class="ruby">    i386-linux.kernel.bvmlinuz           bvmlinuz/i386</span></span><br><span class="line"><span class="ruby">    i386-linux.kernel.vmlinux            vmlinux/i386</span></span><br><span class="line"><span class="ruby">    i386-linux.kernel.vmlinuz            vmlinuz/i386</span></span><br><span class="line"><span class="ruby">    i386-netbsd.elf                      netbsd/i386</span></span><br><span class="line"><span class="ruby">    i386-openbsd.elf                     openbsd/i386</span></span><br><span class="line"><span class="ruby">    i386-win32.pe                        win32/pe</span></span><br><span class="line"><span class="ruby">    m68k-atari.tos                       atari/tos</span></span><br><span class="line"><span class="ruby">    mips-linux.elf                       linux/mips</span></span><br><span class="line"><span class="ruby">    mipsel-linux.elf                     linux/mipsel</span></span><br><span class="line"><span class="ruby">    mipsel.r300<span class="number">0</span>-ps1                     ps1/exe</span></span><br><span class="line"><span class="ruby">    powerpc-darwin.macho                 macho/ppc32</span></span><br><span class="line"><span class="ruby">    powerpc-linux.elf                    linux/ppc32</span></span><br><span class="line"><span class="ruby">    powerpc-linux.kernel.vmlinux         vmlinux/ppc32</span></span><br><span class="line"><span class="ruby">    powerpc64-linux.elf                  linux/ppc64</span></span><br><span class="line"><span class="ruby">    powerpc64le-darwin.macho             macho/ppc64le</span></span><br><span class="line"><span class="ruby">    powerpc64le-linux.elf                linux/ppc64le</span></span><br><span class="line"><span class="ruby">    powerpc64le-linux.kernel.vmlinux     vmlinux/ppc64le</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">UPX comes with ABSOLUTELY NO WARRANTY; <span class="keyword">for</span> details visit <span class="symbol">https:</span>/<span class="regexp">/upx.github.io</span></span></span><br></pre></td></tr></table></figure></p>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><ul>
<li>压缩<strong>可执行文件</strong>，压缩后的文件依然是可执行文件，并不影响程序的执行</li>
<li>老牌压缩软件，稳定，跨平台支持最好</li>
<li>团队维护，开发人员依然活跃</li>
<li>压缩比一般在20%-30%，如：10M压缩至3M</li>
</ul>
<h2 id="Docker运行镜像"><a href="#Docker运行镜像" class="headerlink" title="Docker运行镜像"></a>Docker运行镜像</h2><h3 id="alpine"><a href="#alpine" class="headerlink" title="alpine"></a>alpine</h3><p>“Alpine Linux是一个面向安全的轻型的Linux发行版,基于Alpine Linux的超小型Docker镜像,大小只有5MB，并且可以访问比其他基于BusyBox的镜像更完整的包存储库。 Alpine Linux采用了 musl libc和busybox以减小系统的体积和运行时资源消耗，由于小巧、功能完备，非常适合用于作为容器的基础镜像。”</p>
<p><strong>特点</strong></p>
<ul>
<li>轻量型linux发行版本，包含基于busybox的一些常用工具集</li>
<li>初始镜像大小在5M左右</li>
</ul>
<h3 id="scratch"><a href="#scratch" class="headerlink" title="scratch"></a>scratch</h3><p>“an explicitly empty image, especially for building images <code>FROM scratch</code>“</p>
<p><strong>特点</strong></p>
<ul>
<li>docker的虚拟镜像，镜像大小接近于0</li>
<li>通过<code>FROM scratch</code>指令引用，没有真实镜像文件</li>
</ul>
<h2 id="关于选择Go服务依赖包"><a href="#关于选择Go服务依赖包" class="headerlink" title="关于选择Go服务依赖包"></a>关于选择Go服务依赖包</h2><p>“选择合适的，功能满足即可，不求大而全”</p>
<p>例:</p>
<p>采用一个功能齐全的配置解析包来解析yaml</p>
<p>服务 &lt; spf13/viper &lt; fsnotify &lt; golang.org/x/sys/unix</p>
<ul>
<li>编译大小: 8M</li>
</ul>
<p>服务 &lt; yaml.v2</p>
<ul>
<li>编译大小: 5M</li>
</ul>
</div><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="https://oldchan.net/2021/03/30/container/docker/minimum_ext/" data-id="clcyms1oa002grsu3m7p6iu0g" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACKElEQVR42u3aS27DMAxF0ex/0+4CXLn3kWoAU1ejIHFsHQ8I8fP54HXd1v3X1fX3a1Z3W91/25IhQ8ZrGdfj6j/4wouAl0+UIUPGAYzV43m4TF8Kf9bz3mTIkCGDXEOOjChoypAhQ8ZWBk9c003LkCFDRieJ5cE0fR08ed6Qi8uQIeOFDF51//7nf+lvyJAh41WMK1zPzYC00L9tVzJkyBjN4AGOH8v40a0TcGXIkHEaIy3i1wYj0juQ0h56NzJkyBjB6G+xdmTkTQWEkSFDxmgGL9PXGgm1Uv6GBoAMGTKGMtLxi86BshZMA5gMGTJGMGqHuVpxn2yIj5rJkCHjTAYPgrXmJbkybTn80YmVIUPGOEY66JAG6LSRSQ6IMmTIOIERh7awNEY2kebcQRlOhgwZgxjpw2qHyK8OW8iQIWMQg9w63QRvi9aGNn75RoYMGaMZtU2nBbXa6MaG0QoZMmSMYNSai2lxbVfAXT5dhgwZoxmdI92u1JSPmm3LxWXIkDGOwb9PGwy1BDhIYmXIkDGUUTu6kVBL7tZ5QTJkyDiHwf/cGQXjATeYFpEhQ8ZQxhUunoKSAJqG4CVbhgwZoxlpl7CT7pL2Z2fKS4YMGbMZ/QYAD53pETB43zJkyDiAUQt8PJbz11TbrQwZMmSkY2H9wBpTZciQIaNd9iLb4m2GoIUpQ4aMQYxOOspDZ+1XVP6TIUPGaEaaOvZv3RkCazUyZciQ8T7GDzi1slC+E2MxAAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/容器化/"><i class="fa fa-tag"></i>容器化</a></div><div class="post-nav"><a class="pre" href="/2021/04/06/arch/middleware/configuration/">配置服务迁移</a><a class="next" href="/2021/02/20/language/go/struct_like_class/">Go：实现类似class的析构函数</a></div><div id="tcomment"></div><script src="https://fastly.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js"></script><script>twikoo.init({
  envId: 'thecxx-1gxw7szk895715fd',
  el: '#tcomment',
  region: 'ap-shanghai',
  path: ''
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/容器/">容器</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/架构/">架构</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/笔记/">笔记</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/系统/">系统</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/长话/">长话</a><span class="category-list-count">4</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/中间件/" style="font-size: 15px;">中间件</a> <a href="/tags/思考/" style="font-size: 15px;">思考</a> <a href="/tags/博客/" style="font-size: 15px;">博客</a> <a href="/tags/元宇宙/" style="font-size: 15px;">元宇宙</a> <a href="/tags/cpu/" style="font-size: 15px;">cpu</a> <a href="/tags/微服务/" style="font-size: 15px;">微服务</a> <a href="/tags/容器化/" style="font-size: 15px;">容器化</a> <a href="/tags/go/" style="font-size: 15px;">go</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/windows/" style="font-size: 15px;">windows</a> <a href="/tags/注入/" style="font-size: 15px;">注入</a> <a href="/tags/golang/" style="font-size: 15px;">golang</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/01/15/notes/golang/advanced/boot/">Golang深度解读：启动</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/12/10/notes/golang/advanced/schedule/">Golang深度解读：调度</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/08/15/notes/golang/advanced/p/">Golang深度解读：P</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/24/notes/golang/advanced/m/">Golang深度解读：M</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/10/notes/golang/advanced/g0/">Golang深度解读：g0</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/07/10/notes/golang/advanced/list/">Golang深度解读</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/06/15/opinion/give_up_the_php/">6年前，决定不再继续精进PHP</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/05/05/opinion/good_product/">好的产品?</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/11/17/opinion/internet_and_metaverse/">互联网络与元宇宙</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/05/18/arch/microservice/service/">微服务</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">KAMI.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//fastly.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//fastly.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/prettify.js?v=1.0.0"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script><script type="text/javascript" src="/js/codeblock-render.js?v=1.0.0"></script></div></body></html>